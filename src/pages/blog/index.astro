<!-- // src/pages/blog/index.astro -->
---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { getAllBlogPosts } from '../../lib/blog';

const allPosts = await getAllBlogPosts();
const PAGE_SIZE = 12;
const page = 1;
const totalPages = Math.max(1, Math.ceil(allPosts.length / PAGE_SIZE));
const pagePosts = allPosts.slice(0, PAGE_SIZE);

const siteUrl = (Astro.site?.toString() ?? 'https://www.srijanakimahaltrustofficial.com').replace(/\/$/, '');
const nextHref = page < totalPages ? `${siteUrl}/blog/page/${page + 1}` : null;
---

<Layout 
  title="Blog - Sri Janaki Mahal Trust | Ayodhya Travel Guides & Room Booking Tips"
  description="Read our blog for guides on visiting Ayodhya, Ram Mandir, room booking, and staying at Sri Janaki Mahal Trust. Expert travel tips and booking guides."
  keywords={[
    'Sri Janaki Mahal Trust blog',
    'Ayodhya travel guide',
    'Ram Mandir guide',
    'Sri Janaki Mahal Trust room booking',
    'online booking Ayodhya',
    'Sri Janaki Mahal Trust official',
    'book room online',
    'Ayodhya dharmshala guide'
  ]}
  canonical="/blog"
  ogType="website"
>
  <Fragment slot="head">
    {nextHref && <link rel="next" href={nextHref} />}
  </Fragment>
  <Header />
  
  <main class="min-h-screen bg-[#faf8f3] py-12">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Header Section -->
      <div class="text-center mb-12">
        <h1 class="text-4xl sm:text-5xl font-bold text-gray-900 mb-4">
          Sri Janaki Mahal Trust Blog
        </h1>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto">
          Your guide to visiting Ayodhya, Ram Mandir, room booking, and experiencing the best of Sri Janaki Mahal Trust
        </p>
      </div>

      <!-- Blog Posts Grid -->
      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
        {pagePosts.map((post) => (
          <article class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
            <a href={`/blog/${post.slug}`} class="block">
              <div class="p-6">
                <div class="flex items-center gap-2 text-sm text-gray-500 mb-3">
                  <time datetime={post.date}>{new Date(post.date).toLocaleDateString('en-IN', { year: 'numeric', month: 'long', day: 'numeric' })}</time>
                  <span>•</span>
                  <span>{post.readTime}</span>
                </div>
                <h2 class="text-xl font-bold text-gray-900 mb-3 hover:text-amber-600 transition-colors">
                  {post.title}
                </h2>
                <p class="text-gray-600 leading-relaxed mb-4">
                  {post.description}
                </p>
                <span class="text-amber-600 font-semibold hover:text-amber-700">
                  Read more →
                </span>
              </div>
            </a>
          </article>
        ))}
      </div>

      <!-- Pagination -->
      {totalPages > 1 && (
        <nav class="flex items-center justify-center gap-2 mb-12" aria-label="Blog pagination">
          <a
            href="/blog"
            aria-current="page"
            class="px-4 py-2 rounded-lg bg-amber-600 text-white font-semibold"
          >
            1
          </a>
          {Array.from({ length: Math.min(totalPages - 1, 6) }).map((_, i) => {
            const pageNum = i + 2;
            return (
              <a
                href={`/blog/page/${pageNum}`}
                class="px-4 py-2 rounded-lg bg-white text-gray-900 border border-gray-200 hover:border-amber-600 hover:text-amber-700 transition-colors"
              >
                {pageNum}
              </a>
            );
          })}
          {totalPages > 7 && (
            <span class="px-2 text-gray-500" aria-hidden="true">…</span>
          )}
          <a
            href={`/blog/page/2`}
            class="px-4 py-2 rounded-lg bg-white text-gray-900 border border-gray-200 hover:border-amber-600 hover:text-amber-700 transition-colors"
          >
            Next →
          </a>
        </nav>
      )}

      <!-- Call to Action -->
      <div class="bg-gradient-to-r from-amber-600 to-rose-600 rounded-lg p-8 text-center text-white">
        <h2 class="text-2xl font-bold mb-4">Ready to Experience Ayodhya?</h2>
        <p class="text-lg mb-6 opacity-90">
          Book your stay at Sri Janaki Mahal Trust today
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a 
            href="tel:+918679304702"
            class="px-6 py-3 bg-white text-amber-600 font-bold rounded-lg hover:bg-gray-100 transition-colors"
          >
            Call Now: +91 8679304702
          </a>
          <a 
            href="https://wa.me/918679304702"
            target="_blank"
            rel="noopener noreferrer"
            class="px-6 py-3 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 transition-colors"
          >
            WhatsApp Booking
          </a>
        </div>
      </div>
    </div>
  </main>

  <Footer />
</Layout>

